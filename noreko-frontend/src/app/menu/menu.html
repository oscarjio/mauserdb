<!-- VPN Status Indicator för admin -->
<div class="vpn-status-indicator" *ngIf="loggedIn && user?.role === 'admin' && vpnConnectedCount > 0">
  <span class="vpn-status-text">
    <i class="fas fa-network-wired me-1"></i>
    {{ vpnConnectedCount }} {{ vpnConnectedCount === 1 ? 'användare ansluten' : 'användare anslutna' }} till VPN
  </span>
</div>
<nav class="navbar navbar-expand-lg navbar-dark bg-dark custom-navbar">
  <div class="container-fluid">
    <ul class="navbar-nav ms-auto align-items-center custom-menu">
      <li class="nav-item">
        <a class="nav-link active" aria-current="page" routerLink="/">Hem</a>
      </li>
      <li class="nav-item" *ngIf="loggedIn && user?.role === 'admin'">
        <a class="nav-link text-info" routerLink="/oversikt"><i class="fas fa-tachometer-alt me-1"></i>Översikt</a>
      </li>
      <li class="nav-item" *ngIf="loggedIn">
        <a class="nav-link" routerLink="/stopporsaker"><i class="fas fa-exclamation-triangle me-1"></i>Stopporsaker</a>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="rebotlingDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
          Rebotling
        </a>
        <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="rebotlingDropdown">
          <li><a class="dropdown-item" routerLink="/rebotling/live">Live</a></li>
          <li><a class="dropdown-item" routerLink="/rebotling/skiftrapport">Skiftrapport</a></li>
          <li><a class="dropdown-item" routerLink="/rebotling/statistik">Statistik</a></li>
          <li *ngIf="loggedIn"><hr class="dropdown-divider"></li>
          <li *ngIf="loggedIn"><a class="dropdown-item" routerLink="/min-bonus"><i class="fas fa-star me-2 text-info"></i>Min Bonus</a></li>
          <li *ngIf="loggedIn && user?.role === 'admin'"><hr class="dropdown-divider"></li>
          <li *ngIf="loggedIn && user?.role === 'admin'"><a class="dropdown-item text-warning" routerLink="/rebotling/admin"><i class="fas fa-cogs me-2"></i>Admin</a></li>
          <li *ngIf="loggedIn && user?.role === 'admin'"><a class="dropdown-item text-warning" routerLink="/rebotling/bonus"><i class="fas fa-trophy me-2"></i>Bonus</a></li>
          <li *ngIf="loggedIn && user?.role === 'admin'"><a class="dropdown-item text-warning" routerLink="/rebotling/bonus-admin"><i class="fas fa-sliders-h me-2"></i>Bonus Admin</a></li>
        </ul>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="tvattlinjeDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
          Tvättlinje
        </a>
        <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="tvattlinjeDropdown">
          <li><a class="dropdown-item" routerLink="/tvattlinje/live">Live</a></li>
          <li><a class="dropdown-item" routerLink="/tvattlinje/skiftrapport">Skiftrapport</a></li>
          <li><a class="dropdown-item" routerLink="/tvattlinje/statistik">Statistik</a></li>
          <li *ngIf="loggedIn && user?.role === 'admin'"><hr class="dropdown-divider"></li>
          <li *ngIf="loggedIn && user?.role === 'admin'"><a class="dropdown-item text-warning" routerLink="/tvattlinje/admin"><i class="fas fa-cogs me-2"></i>Admin</a></li>
        </ul>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="saglinjeDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
          Såglinje
        </a>
        <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="saglinjeDropdown">
          <li><a class="dropdown-item" routerLink="/saglinje/live">Live</a></li>
          <li><a class="dropdown-item" routerLink="/saglinje/skiftrapport">Skiftrapport</a></li>
          <li><a class="dropdown-item" routerLink="/saglinje/statistik">Statistik</a></li>
        </ul>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="klassificeringslinjeDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
          Klassificeringslinje
        </a>
        <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="klassificeringslinjeDropdown">
          <li><a class="dropdown-item" routerLink="/klassificeringslinje/live">Live</a></li>
          <li><a class="dropdown-item" routerLink="/klassificeringslinje/skiftrapport">Skiftrapport</a></li>
          <li><a class="dropdown-item" routerLink="/klassificeringslinje/statistik">Statistik</a></li>
        </ul>
      </li>

      <li class="nav-item dropdown" *ngIf="!loggedIn">
        <a class="nav-link dropdown-toggle" href="#" id="loginDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
          Login
        </a>
        <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="loginDropdown">
          <li><a class="dropdown-item" routerLink="/login">Login</a></li>
          <li><a class="dropdown-item" routerLink="/register">Register</a></li>
        </ul>
      </li>
      <li class="nav-item dropdown" *ngIf="loggedIn">
        <a class="nav-link dropdown-toggle user-name" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
          {{ user?.username }}
        </a>
        <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="userDropdown">
          <li class="dropdown-header" *ngIf="user?.role !== 'admin'">Mitt konto</li>
          <li class="px-3 py-2 account-settings" *ngIf="user?.role !== 'admin'">
            <form (ngSubmit)="updateProfile()" (click)="$event.stopPropagation()" novalidate>
              <div class="mb-2">
                <label class="form-label account-label" for="accountEmail">E-post</label>
                <input
                  type="email"
                  class="form-control form-control-sm"
                  id="accountEmail"
                  name="accountEmail"
                  required
                  [(ngModel)]="profileForm.email" />
              </div>
              <div class="mb-2">
                <label class="form-label account-label" for="newPassword">Nytt lösenord</label>
                <input
                  type="password"
                  class="form-control form-control-sm"
                  id="newPassword"
                  name="newPassword"
                  [(ngModel)]="profileForm.newPassword" />
              </div>
              <div class="mb-2">
                <label class="form-label account-label" for="confirmPassword">Bekräfta nytt lösenord</label>
                <input
                  type="password"
                  class="form-control form-control-sm"
                  id="confirmPassword"
                  name="confirmPassword"
                  [(ngModel)]="profileForm.confirmPassword" />
              </div>
              <div class="mb-2">
                <label class="form-label account-label" for="currentPassword">Nuvarande lösenord</label>
                <input
                  type="password"
                  class="form-control form-control-sm"
                  id="currentPassword"
                  name="currentPassword"
                  [required]="(profileForm?.newPassword?.length || 0) > 0 || (profileForm?.confirmPassword?.length || 0) > 0"
                  [(ngModel)]="profileForm.currentPassword" />
                <small class="text-muted d-block mt-1">Behövs bara vid byte av lösenord.</small>
              </div>
              <div class="alert alert-success py-1 px-2 mb-2" *ngIf="profileMessage">{{ profileMessage }}</div>
              <div class="alert alert-danger py-1 px-2 mb-2" *ngIf="profileError">{{ profileError }}</div>
              <button class="btn btn-sm btn-primary w-100" type="submit" [disabled]="savingProfile">
                {{ savingProfile ? 'Sparar…' : 'Spara' }}
              </button>
            </form>
          </li>
          <li *ngIf="user?.role !== 'admin'"><hr class="dropdown-divider" /></li>
          <li><a class="dropdown-item" (click)="logout()">Logga ut</a></li>
        </ul>
      </li>
      <li class="nav-item dropdown" *ngIf="loggedIn && user?.role === 'admin'">
        <a class="nav-link dropdown-toggle" href="#" id="adminDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
          Admin
        </a>
        <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="adminDropdown">
          <li><a class="dropdown-item" routerLink="/admin/users">Användare</a></li>
          <li><a class="dropdown-item" routerLink="/admin/create-user">Skapa användare</a></li>
          <li><hr class="dropdown-divider"></li>
          <li><a class="dropdown-item" routerLink="/admin/vpn"><i class="fas fa-network-wired me-2"></i>VPN</a></li>
          <li><a class="dropdown-item" routerLink="/admin/audit"><i class="fas fa-history me-2"></i>Aktivitetslogg</a></li>
        </ul>
      </li>
      <li class="nav-item dropdown menu-selector-item">
        <select [(ngModel)]="selectedMenu" (change)="onMenuChange($event)" class="menu-selector">
          <option value="Älvängen">Älvängen</option>
          <option value="Moss">Moss</option>
        </select>
      </li>
    </ul>
  </div>
</nav>
