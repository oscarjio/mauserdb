<div class="users-page">
  <h2>Användare</h2>
  <div *ngIf="loading">Laddar användare...</div>
  <div *ngIf="error" class="text-danger">{{ error }}</div>
  <table class="table table-striped" *ngIf="users.length">
    <thead>
      <tr>
        <th>Användarnamn</th>
        <th>Email</th>
        <th>Telefon</th>
        <th>Senaste inloggning</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <ng-container *ngFor="let user of users">
        <tr>
          <td>{{ user.username }}</td>
          <td>{{ user.email }}</td>
          <td>{{ user.phone }}</td>
          <td>{{ user.last_login || '-' }}</td>
          <td>
            <button class="btn btn-sm btn-outline-primary" (click)="toggleExpand(user.id)">
              {{ expanded[user.id] ? 'Stäng' : 'Redigera' }}
            </button>
          </td>
        </tr>
        <tr *ngIf="expanded[user.id]" class="edit-row">
          <td colspan="5">
            <form (ngSubmit)="saveUser(user)" class="edit-form">
              <div class="row g-2 align-items-center">
                <div class="col">
                  <input class="form-control" [(ngModel)]="user.username" name="username-{{user.id}}" placeholder="Användarnamn" required />
                </div>
                <div class="col">
                  <input class="form-control" [(ngModel)]="user.email" name="email-{{user.id}}" placeholder="Email" />
                </div>
                <div class="col">
                  <input class="form-control" [(ngModel)]="user.phone" name="phone-{{user.id}}" placeholder="Telefon" />
                </div>
                <div class="col">
                  <input class="form-control" [(ngModel)]="user.password" name="password-{{user.id}}" placeholder="Nytt lösenord" type="password" />
                </div>
                <div class="col">
                  <button class="btn btn-success" type="submit">Spara</button>
                </div>
              </div>
            </form>
          </td>
        </tr>
      </ng-container>
    </tbody>
  </table>
  <div *ngIf="!users.length && !loading">Inga användare hittades.</div>
</div> 